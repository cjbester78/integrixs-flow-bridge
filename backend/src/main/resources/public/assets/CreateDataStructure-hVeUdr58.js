import{j as e}from"./ui-vendor-B4gDKxp2.js";import{r as p,R as Pe,u as Oe,i as Re,d as ke}from"./react-vendor-pDgKdaAw.js";import{a as Me,b as he,c as We,u as qe,p as Ie,d as Ue,f as Xe}from"./useDataStructures-z7rYwHdH.js";import{w as Je,a4 as ie,E as Y,g as y,S as W,h as q,i as I,j as U,k as T,I as A,A as we,d as De,v as O,a5 as Te,m as Be,o as Z,p as ae,q as re,s as ue,r as ne,l as G,L as z,U as _e,F as V,a6 as H,G as Ge,e as ze,b as Ve,a7 as He,a8 as Ye,z as Ke,B as je}from"./index-DseL_RUD.js";import{T as ee}from"./textarea-CpMMCY-d.js";import{D as ge,b as ve,c as ye,d as fe,e as Qe,f as Se}from"./dialog-C8_RbV56.js";import{R as Ne,a as se}from"./radio-group-B2DP7j6C.js";import{u as Ze}from"./useQuery-BjZrm5F3.js";import{u as es}from"./useMutation-BNhkhKHE.js";import{D as oe}from"./download-CW1087ur.js";import{b as ss}from"./businessComponentService-p4rxceWm.js";import{T as ts,a as as,b as K,c as Q}from"./tabs-C7kSaJO6.js";import{U as rs}from"./upload-DCFlz6R9.js";import{F as ns}from"./file-json-BQ29TB7B.js";import{F as me}from"./file-code-Z4QaeDf1.js";import{T as cs}from"./trash-2-DvXNCKbG.js";import{P as de}from"./plus-BSv1nIAt.js";import{D as Ce}from"./database-BVjBpfEA.js";import{S as ls}from"./save-B_a1ZW5d.js";import{S as is}from"./square-pen-o8_DZBzY.js";import{s as os}from"./structureService-Dc5v0Sew.js";import{L as be}from"./layers-CdVjnHt8.js";import"./chart-vendor-A7Ge_5Hb.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=Je("FileCode2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m5 12-3 3 3 3",key:"oke12k"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);function us({isOpen:s,onClose:a}){const[t,n]=p.useState("SOURCE"),[c,u]=p.useState("SYNCHRONOUS"),[l,r]=p.useState(""),[m,i]=p.useState(""),[d,o]=p.useState(""),[h,v]=p.useState(""),[j,b]=p.useState(""),[f,S]=p.useState(""),[w,D]=p.useState(null),[L,P]=p.useState(""),[R,E]=p.useState(!1),{data:F=[],isLoading:X}=Ze({queryKey:["xml-data-structures"],queryFn:async()=>await ie.get("/wsdl/structures/xml"),enabled:s}),J=es({mutationFn:async x=>await ie.post("/wsdl/generate",x),onSuccess:x=>{D(x),Y({title:"Success",description:"WSDL generated successfully"})},onError:x=>{Y({title:"Error",description:x.response?.data?.message||"Failed to generate WSDL",variant:"destructive"})}});p.useEffect(()=>{l&&F.find(x=>x.id===l)},[l,F]);const k=async()=>{if(!h||!j||!f||!l){Y({title:"Error",description:"Please fill all required fields",variant:"destructive"});return}if(c==="SYNCHRONOUS"&&!m){Y({title:"Error",description:"Response structure is required for synchronous WSDL",variant:"destructive"});return}const x={mode:t,type:c,requestStructureId:l,responseStructureId:c==="SYNCHRONOUS"?m:void 0,faultStructureId:d||void 0,serviceName:h,namespace:j,operationName:f};J.mutate(x)},M=async()=>{if(w)try{const x=await ie.get(`/wsdl/preview/${w.wsdlId}`,{responseType:"text"});P(x.data||""),E(!0)}catch{Y({title:"Error",description:"Failed to preview WSDL",variant:"destructive"})}},$=()=>{if(!w)return;const x=document.createElement("a");x.href=`/api${w.downloadUrl}`,x.download=`${h}.wsdl`,document.body.appendChild(x),x.click(),document.body.removeChild(x)},B=()=>{n("SOURCE"),u("SYNCHRONOUS"),r(""),i(""),o(""),v(""),b(""),S(""),D(null),P(""),E(!1),a()};return e.jsxs(e.Fragment,{children:[";",e.jsx(ge,{open:s&&!R,onOpenChange:B,children:e.jsxs(ve,{className:"max-w-2xl",children:[e.jsxs(ye,{children:[e.jsx(fe,{children:"Generate WSDL"}),e.jsx(Qe,{children:"Generate a WSDL 1.1 file from existing XML/XSD data structures"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{children:"WSDL Mode"}),e.jsxs(Ne,{value:t,onValueChange:x=>n(x),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{value:"SOURCE",id:"source"}),e.jsx(y,{htmlFor:"source",children:"Source (Outbound service)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{value:"TARGET",id:"target"}),e.jsx(y,{htmlFor:"target",children:"Target (Inbound service)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{children:"WSDL Type"}),e.jsxs(Ne,{value:c,onValueChange:x=>u(x),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{value:"SYNCHRONOUS",id:"sync"}),e.jsx(y,{htmlFor:"sync",children:"Synchronous (Request/Response)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{value:"ASYNCHRONOUS",id:"async"}),e.jsx(y,{htmlFor:"async",children:"Asynchronous (Request only)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"request",children:"Request Structure *"}),e.jsxs(W,{value:l,onValueChange:r,children:[e.jsx(q,{id:"request",children:e.jsx(I,{placeholder:"Select request structure"})}),e.jsx(U,{children:F.map(x=>e.jsxs(T,{value:x.id,children:[x.name," ",x.description&&`- ${x.description}`]},x.id))})]})]}),c==="SYNCHRONOUS"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"response",children:"Response Structure *"}),e.jsxs(W,{value:m,onValueChange:i,children:[e.jsx(q,{id:"response",children:e.jsx(I,{placeholder:"Select response structure"})}),e.jsx(U,{children:F.map(x=>e.jsxs(T,{value:x.id,children:[x.name," ",x.description&&`- ${x.description}`]},x.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"fault",children:"Fault Structure (Optional)"}),e.jsxs(W,{value:d,onValueChange:o,children:[e.jsx(q,{id:"fault",children:e.jsx(I,{placeholder:"Select fault structure (optional)"})}),e.jsxs(U,{children:[e.jsx(T,{value:"",children:"None"}),F.map(x=>e.jsxs(T,{value:x.id,children:[x.name," ",x.description&&`- ${x.description}`]},x.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"service-name",children:"Service Name *"}),e.jsx(A,{id:"service-name",value:h,onChange:x=>v(x.target.value),placeholder:"e.g., CustomerService"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"namespace",children:"Namespace *"}),e.jsx(A,{id:"namespace",value:j,onChange:x=>b(x.target.value),placeholder:"e.g., http://example.com/services/customer"}),!j&&l&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter namespace or it will be extracted from request structure if available"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"operation",children:"Operation Name *"}),e.jsx(A,{id:"operation",value:f,onChange:x=>S(x.target.value),placeholder:"e.g., getCustomer"})]}),w&&e.jsx(we,{children:e.jsxs(De,{children:["WSDL generated successfully! ",w.createdStructures.length," data structures were created."]})})]}),e.jsxs(Se,{children:[e.jsx(O,{variant:"outline",onClick:B,children:"Cancel"}),w?e.jsxs(e.Fragment,{children:[e.jsxs(O,{variant:"outline",onClick:M,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Preview"]}),e.jsxs(O,{onClick:$,children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Download"]})]}):e.jsxs(O,{onClick:k,disabled:J.isPending||X,children:[J.isPending&&e.jsx(Be,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate WSDL"]})]})]})}),e.jsx(ge,{open:R,onOpenChange:E,children:e.jsxs(ve,{className:"max-w-4xl max-h-[80vh]",children:[e.jsx(ye,{children:e.jsx(fe,{children:"WSDL Preview"})}),e.jsx("div",{className:"overflow-auto",children:e.jsx("pre",{className:"text-sm bg-gray-100 p-4 rounded",children:L})}),e.jsxs(Se,{children:[e.jsx(O,{variant:"outline",onClick:()=>E(!1),children:"Close"}),e.jsxs(O,{onClick:$,children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})})]})}const ms=({structureName:s,setStructureName:a,structureDescription:t,setStructureDescription:n,structureUsage:c="source",setStructureUsage:u,isEditMode:l=!1})=>{const[r,m]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{className:"animate-scale-in",children:[e.jsx(ae,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[";",e.jsxs(re,{children:[l?"Edit":"Create"," Data Structure"]}),e.jsx(ue,{children:"Import existing schemas or create custom structures"})]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>m(!0),className:"gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"Generate WSDL"]})]})}),e.jsx(ne,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"structureName",children:"Structure Name *"}),e.jsx(A,{id:"structureName",placeholder:"e.g., Customer Order Schema",value:s,onChange:i=>a(i.target.value),className:"transition-all duration-300 focus:scale-[1.01]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"description",children:"Description"}),e.jsx(ee,{id:"description",placeholder:"Describe the purpose and context of this data structure...",value:t,onChange:i=>n(i.target.value),className:"transition-all duration-300 focus:scale-[1.01]",rows:3})]}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"usage",children:"Usage"}),e.jsxs(W,{value:c,onValueChange:i=>{const d=i;if(u(d),s){let o=s;(o.endsWith("_Out")||o.endsWith("_In"))&&(o=o.substring(0,o.length-4)),a(o+(d==="source"?"_Out":"_In"))}},children:[e.jsx(q,{id:"usage",children:e.jsx(I,{})}),e.jsxs(U,{children:[e.jsx(T,{value:"source",children:"Source (Outbound)"}),e.jsx(T,{value:"target",children:"Target (Inbound)"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Source structures are used by Inbound Adapters (outbound - receive FROM external systems). Target structures are used by Outbound Adapters (inbound - send TO external systems)"})]})]})})]}),e.jsx(us,{isOpen:r,onClose:()=>m(!1)})]})},xs=({selectedBusinessComponent:s,setSelectedBusinessComponent:a})=>{const[t,n]=p.useState([]),[c,u]=p.useState(!0);p.useEffect(()=>{l()},[]);const l=async()=>{try{u(!0);const r=await ss.getAllBusinessComponents();if(r.success&&r.data){const m=Array.isArray(r.data)?r.data:[];n(m)}}catch(r){G.error(z.UI,"Error loading business components",{error:r}),n([])}finally{u(!1)}};return e.jsxs(Z,{className:"animate-scale-in",children:[e.jsxs(ae,{children:[e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Business Component Selection"]}),e.jsx(ue,{children:"Select the business component this data structure belongs to"})]}),e.jsx(ne,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"businessComponent",children:"Business Component *"}),e.jsxs(W,{value:s?.id||"",onValueChange:r=>{const m=t.find(i=>i.id===r)||null;a(m)},disabled:c,children:[e.jsx(q,{children:e.jsx(I,{placeholder:"Select a business component"})}),e.jsx(U,{children:t.length===0?e.jsx("div",{className:"p-2 text-sm text-muted-foreground text-center",children:"No business components available"}):t.map(r=>e.jsx(T,{value:r.id,children:r.name},r.id))})]})]})})]})},ce=({icon:s,title:a,description:t,acceptTypes:n,dragOver:c,onDrop:u,onDragOver:l,onDragLeave:r,onFileSelect:m,uploadId:i,buttonText:d})=>e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${c?"border-primary bg-primary/10":"border-border"}`,onDrop:u,onDragOver:l,onDragLeave:r,children:[e.jsx(s,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:t}),e.jsx("input",{type:"file",accept:n,onChange:o=>o.target.files?.[0]&&m(o.target.files[0]),className:"hidden",id:i}),e.jsxs(O,{variant:"outline",onClick:()=>document.getElementById(i)?.click(),children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),d]})]}),ps=({jsonInput:s,setJsonInput:a,onResetAllFields:t,onFileUploaded:n})=>{const[c,u]=p.useState(!1),{toast:l}=V(),r=d=>{const o=new FileReader;o.onload=h=>{const v=h.target?.result;try{const j=JSON.parse(v);a(JSON.stringify(j,null,2)),n&&n(d.name),l({title:"JSON File Loaded",description:`Successfully loaded ${d.name}`})}catch{l({title:"Invalid JSON",description:"The uploaded file contains invalid JSON",variant:"destructive"})}},o.readAsText(d)},m=d=>{d.preventDefault(),u(!1);const o=Array.from(d.dataTransfer.files);o.length>0&&r(o[0])},i=()=>{t(),l({title:"All Fields Cleared",description:"All form fields have been reset"})};return e.jsxs("div",{className:"space-y-4",children:[!s.trim()&&e.jsx(ce,{icon:ns,title:"JSON Upload",description:"Drag & drop a JSON file or paste JSON structure below",acceptTypes:".json",dragOver:c,onDrop:m,onDragOver:d=>{d.preventDefault(),u(!0)},onDragLeave:()=>u(!1),onFileSelect:r,uploadId:"json-upload",buttonText:"Upload JSON File"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{children:"JSON Structure"}),s.trim()&&e.jsxs(O,{variant:"outline",size:"sm",onClick:i,className:"text-destructive hover:text-destructive",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Clear JSON"]})]}),e.jsx(ee,{placeholder:'{"orderId": "string", "amount": 100.50, "items": []}',value:s,onChange:d=>a(d.target.value),className:"font-mono text-sm",rows:8})]})]})},xe=({type:s,namespaceConfig:a,setNamespaceConfig:t,hideSchemaLocation:n=!1})=>{const c=s==="wsdl";return e.jsxs(Z,{className:"p-4 bg-muted/30",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),c?"WSDL":"XML"," Namespace Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{className:"text-xs",children:c?"Service Namespace *":"Namespace URI *"}),e.jsx(A,{placeholder:c?"http://example.com/service":"http://example.com/namespace",value:a.uri,onChange:u=>t({...a,uri:u.target.value}),className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{className:"text-xs",children:c?"Service Prefix":"Namespace Prefix"}),e.jsx(A,{placeholder:c?"svc":"ns1",value:a.prefix,onChange:u=>t({...a,prefix:u.target.value}),className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{className:"text-xs",children:"Target Namespace"}),e.jsx(A,{placeholder:"http://example.com/target",value:a.targetNamespace,onChange:u=>t({...a,targetNamespace:u.target.value}),className:"text-sm"})]}),!n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{className:"text-xs",children:c?"WSDL Location":"Schema Location"}),e.jsx(A,{placeholder:c?"http://example.com/service.wsdl":"http://example.com/schema.xsd",value:a.schemaLocation,onChange:u=>t({...a,schemaLocation:u.target.value}),className:"text-sm"})]})]})]})},hs=({xsdInput:s,setXsdInput:a,namespaceConfig:t,setNamespaceConfig:n,onResetAllFields:c,onFileUploaded:u})=>{const[l,r]=p.useState(!1),{toast:m}=V(),i=h=>{const v=new FileReader;v.onload=j=>{const b=j.target?.result;a(b),u&&u(h.name),m({title:"XSD File Loaded",description:`Successfully loaded ${h.name}`})},v.readAsText(h)},d=h=>{h.preventDefault(),r(!1);const v=Array.from(h.dataTransfer.files);v.length>0&&i(v[0])},o=()=>{c(),m({title:"All Fields Cleared",description:"All form fields have been reset"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(xe,{type:"xml",namespaceConfig:t,setNamespaceConfig:n}),!s.trim()&&e.jsx(ce,{icon:me,title:"XSD Upload",description:"Drag & drop XSD or WSDL files",acceptTypes:".xsd,.wsdl,.xml",dragOver:l,onDrop:d,onDragOver:h=>{h.preventDefault(),r(!0)},onDragLeave:()=>r(!1),onFileSelect:i,uploadId:"xsd-upload",buttonText:"Upload XSD/WSDL"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{children:"XSD/SOAP Content"}),s.trim()&&e.jsxs(O,{variant:"outline",size:"sm",onClick:o,className:"text-destructive hover:text-destructive",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Clear XSD"]})]}),e.jsx(ee,{placeholder:"Paste your XSD or SOAP schema here...",value:s,onChange:h=>a(h.target.value),className:"font-mono text-sm",rows:8})]})]})},js=({wsdlInput:s,setWsdlInput:a,namespaceConfig:t,setNamespaceConfig:n,onWsdlAnalyzed:c,onResetAllFields:u,onFileUploaded:l})=>{const[r,m]=p.useState(!1),[i,d]=p.useState(null),{toast:o}=V(),h=f=>{const{names:S,hasMultiple:w}=Me(f);w?(d(S),o({title:"Multiple Operations Detected",description:`This WSDL contains ${S.length} operations. Please enter a structure name manually.`,variant:"default"})):d(null);const D=he(f),L=We(f);L&&n(L),c&&c(D,L)},v=f=>{const S=new FileReader;S.onload=w=>{const D=w.target?.result;a(D),h(D),l&&!he(D)&&l(f.name),o({title:"WSDL File Loaded",description:`Successfully loaded ${f.name}`})},S.readAsText(f)},j=f=>{f.preventDefault(),m(!1);const S=Array.from(f.dataTransfer.files);S.length>0&&v(S[0])},b=()=>{u(),o({title:"All Fields Cleared",description:"All form fields have been reset"})};return e.jsxs("div",{className:"space-y-4",children:[i&&e.jsxs(we,{children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx(Ve,{children:"Multiple Operations Found"}),e.jsxs(De,{children:["This WSDL contains ",i.length," operations: ",i.join(", "),". Please enter a structure name manually in the form above."]})]}),e.jsx(xe,{type:"wsdl",namespaceConfig:t,setNamespaceConfig:n,hideSchemaLocation:!0}),!s.trim()&&e.jsx(ce,{icon:me,title:"WSDL Upload",description:"Drag & drop a WSDL file or paste WSDL content below",acceptTypes:".wsdl,.xml",dragOver:r,onDrop:j,onDragOver:f=>{f.preventDefault(),m(!0)},onDragLeave:()=>m(!1),onFileSelect:v,uploadId:"wsdl-upload",buttonText:"Upload WSDL File"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{children:"WSDL Content"}),s.trim()&&e.jsxs(O,{variant:"outline",size:"sm",onClick:b,className:"text-destructive hover:text-destructive",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Clear WSDL"]})]}),e.jsx(ee,{placeholder:"Paste your WSDL definition here...",value:s,onChange:f=>{const S=f.target.value;a(S),S.trim()&&h(S)},className:"font-mono text-sm",rows:8})]})]})},gs=({edmxInput:s,setEdmxInput:a,namespaceConfig:t,setNamespaceConfig:n,onResetAllFields:c,onFileUploaded:u})=>{const[l,r]=p.useState(!1),{toast:m}=V(),i=j=>{j.preventDefault(),r(!1);const b=j.dataTransfer.files;b[0]&&h(b[0])},d=j=>{j.preventDefault(),r(!0)},o=()=>{r(!1)},h=j=>{const b=new FileReader;b.onload=f=>{const S=f.target?.result;a(S),u&&u(j.name),m({title:"EDMX File Loaded",description:`Successfully loaded ${j.name}`})},b.readAsText(j)},v=()=>{c(),m({title:"All Fields Cleared",description:"All form fields have been reset"})};return e.jsxs("div",{className:"space-y-4",children:[!s.trim()&&e.jsx(ce,{icon:me,title:"Upload EDMX File",description:"Drag and drop your EDMX file here, or click to browse",acceptTypes:".edmx,.xml",dragOver:l,onDrop:i,onDragOver:d,onDragLeave:o,onFileSelect:h,uploadId:"edmx-upload",buttonText:"Upload EDMX File"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{htmlFor:"edmxInput",children:"EDMX Structure"}),s.trim()&&e.jsxs(O,{variant:"outline",size:"sm",onClick:v,className:"text-destructive hover:text-destructive",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Clear EDMX"]})]}),e.jsx(ee,{id:"edmxInput",placeholder:"Paste your EDMX content here or upload a file above...",value:s,onChange:j=>a(j.target.value),className:"min-h-[300px] font-mono text-sm",rows:15})]}),e.jsx(xe,{type:"xml",namespaceConfig:t,setNamespaceConfig:n})]})},vs=["string","number","boolean","date","datetime","object","array","integer","decimal","email","url"],ys=({field:s,canHaveChildren:a,isExpanded:t,onToggleExpanded:n,onUpdate:c,onRemove:u,depth:l})=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[e.jsx("div",{className:"col-span-1 flex items-center",children:a&&e.jsx(O,{onClick:n,size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover-scale",children:t?e.jsx(He,{className:"h-3 w-3"}):e.jsx(Ye,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(y,{className:"text-xs",children:"Field Name"}),e.jsx(A,{placeholder:"fieldName",value:s.name,onChange:r=>c({name:r.target.value}),className:"text-sm animate-fade-in"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(y,{className:"text-xs",children:"Type"}),e.jsxs(W,{value:s.type,onValueChange:r=>c({type:r}),children:[e.jsx(q,{className:"text-sm",children:e.jsx(I,{})}),e.jsx(U,{children:vs.map(r=>e.jsx(T,{value:r,children:r},r))})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(y,{className:"text-xs",children:"Description"}),e.jsx(A,{placeholder:"Field description...",value:s.description||"",onChange:r=>c({description:r.target.value}),className:"text-sm animate-fade-in"})]}),e.jsx("div",{className:"col-span-2 flex items-center space-x-2",children:e.jsxs("label",{className:"flex items-center space-x-1 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.required,onChange:r=>c({required:r.target.checked}),className:"rounded"}),e.jsx("span",{children:"Required"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx(O,{onClick:u,size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive h-6 w-6 p-0 hover-scale",children:e.jsx(cs,{className:"h-3 w-3"})})})]}),fs=({field:s,canHaveChildren:a,onUpdate:t,onAddChild:n})=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end animate-fade-in",children:[e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-2",children:e.jsxs("label",{className:"flex items-center space-x-1 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.isComplexType||!1,onChange:c=>t({isComplexType:c.target.checked}),className:"rounded"}),e.jsx("span",{children:"Complex Type"})]})}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(y,{className:"text-xs",children:"Min Occurs"}),e.jsx(A,{type:"number",min:"0",placeholder:"0",value:s.minOccurs||0,onChange:c=>t({minOccurs:parseInt(c.target.value)||0}),className:"text-sm"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(y,{className:"text-xs",children:"Max Occurs"}),e.jsxs(W,{value:s.maxOccurs?.toString()||"1",onValueChange:c=>t({maxOccurs:c==="unbounded"?"unbounded":parseInt(c)}),children:[e.jsx(q,{className:"text-sm",children:e.jsx(I,{})}),e.jsxs(U,{children:[e.jsx(T,{value:"1",children:"1"}),e.jsx(T,{value:"2",children:"2"}),e.jsx(T,{value:"5",children:"5"}),e.jsx(T,{value:"10",children:"10"}),e.jsx(T,{value:"unbounded",children:"Unbounded"})]})]})]}),e.jsx("div",{className:"col-span-3",children:a&&e.jsxs(O,{onClick:n,size:"sm",variant:"outline",className:"w-full hover-scale",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Add Child"]})})]}),Ss=({field:s,canHaveChildren:a,isExpanded:t,hasChildren:n,depth:c,path:u,onUpdateChild:l,onRemoveChild:r,onAddGrandChild:m,FieldBuilderComponent:i})=>!a||!t||!n?null:e.jsxs("div",{className:"space-y-3 pl-4 border-l border-border/50 animate-accordion-down",children:[e.jsx(y,{className:"text-xs text-muted-foreground",children:"Child Fields:"}),";",s.children.map((d,o)=>e.jsx(i,{field:d,index:o,onUpdate:l,onRemove:r,onAddChild:m,depth:c+1,path:[...u,o]},o))]}),Ns=(s,a,t,n,c)=>{const u=p.useCallback(d=>{if(d.maxOccurs!==void 0){const o=d.maxOccurs;typeof o=="number"&&o>1||o==="unbounded"?d.type="array":o===1&&s.type==="array"&&(d.type="string")}t(a,d)},[a,t,s.type]),l=p.useCallback(()=>{!s.isComplexType&&s.type!=="object"&&s.type!=="array"&&t(a,{isComplexType:!0}),c(a)},[s.isComplexType,s.type,a,t,c]),r=p.useCallback(d=>{n(d)},[n]),m=p.useCallback((d,o)=>{t(d,o)},[t]),i=p.useCallback(d=>{c(d)},[c]);return{handleUpdate:u,handleAddChild:l,handleRemoveChild:r,handleUpdateChild:m,handleAddGrandChild:i}},$e=({field:s,index:a,onUpdate:t,onRemove:n,onAddChild:c,depth:u,path:l})=>{const[r,m]=Pe.useState(!0),i=!!(s.children&&s.children.length>0),d=s.isComplexType||s.type==="object"||s.type==="array",{handleUpdate:o,handleAddChild:h,handleRemoveChild:v,handleUpdateChild:j,handleAddGrandChild:b}=Ns(s,l,t,n,c);return e.jsxs("div",{className:`space-y-3 p-4 border rounded-lg animate-scale-in ${u>0?"ml-6 border-l-2 border-l-primary/30":""}`,children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(ys,{field:s,canHaveChildren:d,isExpanded:r,onToggleExpanded:()=>m(!r),onUpdate:o,onRemove:()=>n(l),depth:u}),e.jsx(fs,{field:s,canHaveChildren:d,onUpdate:o,onAddChild:h})]}),e.jsx(Ss,{field:s,canHaveChildren:d,isExpanded:r,hasChildren:i,depth:u,path:l,onUpdateChild:j,onRemoveChild:v,onAddGrandChild:b,FieldBuilderComponent:$e})]})},Cs=(s,a)=>{const t=p.useCallback((l,r)=>{const m={name:"",type:"string",required:!1,description:"",isComplexType:!1,minOccurs:0,maxOccurs:1,children:[]};if(r!==void 0&&l!==void 0){const i=[...s];i[r].children[l].children||(i[r].children[l].children=[]),i[r].children[l].children.push(m),a(i)}else if(l!==void 0){const i=[...s];i[l].children||(i[l].children=[]),i[l].children.push(m),a(i)}else a([...s,m])},[s,a]),n=p.useCallback((l,r)=>{G.info(z.BUSINESS_LOGIC,"updateFieldAtPath called:",{path:l,field:r});const m=[...s];let i=m;for(let o=0;o<l.length-1;o++){const h=l[o];i[h].children||(i[h].children=[]),i=i[h].children}const d=l[l.length-1];if(i[d]){if(r.maxOccurs!==void 0){const o=r.maxOccurs;typeof o=="number"&&o>1||o==="unbounded"?r.type="array":o===1&&i[d].type==="array"&&(r.type="string")}i[d]={...i[d],...r},G.info(z.BUSINESS_LOGIC,"Updated field at path:",{data:l,field:i[d]}),a(m)}},[s,a]),c=p.useCallback(l=>{const r=[...s];if(l.length===1)a(r.filter((m,i)=>i!==l[0]));else{let m=r;for(let o=0;o<l.length-2;o++){const h=l[o];if(!m[h].children)return;m=m[h].children}const i=l[l.length-2],d=l[l.length-1];m[i]&&m[i].children&&(m[i].children=m[i].children.filter((o,h)=>h!==d)),a(r)}},[s,a]),u=p.useCallback(l=>{const r={name:"",type:"string",required:!1,description:"",isComplexType:!1,minOccurs:0,maxOccurs:1,children:[]},m=[...s];let i=m;for(let d=0;d<l.length;d++){const o=l[d];i[o].children||(i[o].children=[]),d===l.length-1?i[o].children.push(r):i=i[o].children}a(m)},[s,a]);return{addCustomField:t,updateFieldAtPath:n,removeFieldAtPath:c,addChildAtPath:u}},te=s=>{const a={};return s.forEach(t=>{if(t.name){const n=t.type==="array"||typeof t.maxOccurs=="number"&&t.maxOccurs>1||t.maxOccurs==="unbounded";t.isComplexType||t.children&&t.children.length>0?n?a[t.name]=[te(t.children)]:a[t.name]=te(t.children):a[t.name]=t.type==="integer"?0:""}}),a},bs=s=>{if(s.length===0)return"{}";if(s.length===1&&(s[0].isComplexType||s[0].children)){const t=s[0],n={[t.name]:te(t.children||[])};return JSON.stringify(n,null,2)}const a={root:te(s)};return JSON.stringify(a,null,2)},Os=s=>{let a=`<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xs:element name="root">
 <xs:complexType>
 <xs:sequence>`;return s.forEach(t=>{if(t.name)if(t.isComplexType||t.children&&t.children.length>0)a+=`
 <xs:element name="${t.name}">
 <xs:complexType>
 <xs:sequence>`,t.children?.forEach(n=>{if(n.name){const c=n.minOccurs||(n.required?1:0),u=n.maxOccurs==="unbounded"?"unbounded":n.maxOccurs||1,l=`minOccurs="${c}" maxOccurs="${u}"`;n.isComplexType||n.children&&n.children.length>0?(a+=`
 <xs:element name="${n.name}">
 <xs:complexType>
 <xs:sequence>`,n.children?.forEach(r=>{if(r.name){const m=r.minOccurs||(r.required?1:0),i=r.maxOccurs==="unbounded"?"unbounded":r.maxOccurs||1,d=`minOccurs="${m}" maxOccurs="${i}"`;a+=`
 <xs:element name="${r.name}" type="xs:${r.type==="array"?"string":r.type}" ${d}/>`}}),a+=`
 </xs:sequence>
 </xs:complexType>
 </xs:element>`):a+=`
 <xs:element name="${n.name}" type="xs:${n.type==="array"?"string":n.type}" ${l}/>`}}),a+=`
 </xs:sequence>
 </xs:complexType>
 </xs:element>`;else{const n=t.minOccurs||(t.required?1:0),c=t.maxOccurs==="unbounded"?"unbounded":t.maxOccurs||1,u=`minOccurs="${n}" maxOccurs="${c}"`;a+=`
 <xs:element name="${t.name}" type="xs:${t.type==="array"?"string":t.type}" ${u}/>`}}),a+=`
 </xs:sequence>
 </xs:complexType>
 </xs:element>
</xs:schema>`,a},ws=(s,a="  ")=>{let t="";return(s.isComplexType||s.children&&s.children.length>0)&&(t+=`${a}<xsd:complexType name="${s.name}Type">
${a} <xsd:sequence>`,s.children?.forEach(n=>{if(n.name){const c=n.minOccurs||(n.required?1:0),u=n.maxOccurs==="unbounded"?"unbounded":n.maxOccurs||1,l=`minOccurs="${c}" maxOccurs="${u}"`;if(n.isComplexType||n.children&&n.children.length>0)t+=`
${a} <xsd:element name="${n.name}" type="tns:${n.name}Type" ${l}/>`;else{const r=n.type==="array"?"string":n.type==="integer"?"int":n.type;t+=`
${a} <xsd:element name="${n.name}" type="xsd:${r}" ${l}/>`}}}),t+=`
${a} </xsd:sequence>
${a}</xsd:complexType>`),t},Ds=(s,a="DataService",t="ProcessData")=>{if(s.length===0)return"";let n=`<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://schemas.xmlsoap.org/wsdl/",
  xmlns:tns="http://example.com/service",
  xmlns:xsd="http://www.w3.org/2001/XMLSchema",
  xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
 targetNamespace="http://example.com/service"
 elementFormDefault="qualified">

 <!-- Types Section: XSD definitions for data types -->
 <types>
 <xsd:schema targetNamespace="http://example.com/service",
  xmlns:tns="http://example.com/service">

 <!-- Request Message Type -->
 <xsd:element name="${t}Request">
 <xsd:complexType>
 <xsd:sequence>`;return s.forEach(c=>{if(c.name){const u=c.minOccurs||(c.required?1:0),l=c.maxOccurs==="unbounded"?"unbounded":c.maxOccurs||1,r=`minOccurs="${u}" maxOccurs="${l}"`;if(c.isComplexType||c.children&&c.children.length>0)n+=`
 <xsd:element name="${c.name}" type="tns:${c.name}Type" ${r}/>`;else{const m=c.type==="array"?"string":c.type==="integer"?"int":c.type;n+=`
 <xsd:element name="${c.name}" type="xsd:${m}" ${r}/>`}}}),n+=`
 </xsd:sequence>
 </xsd:complexType>
 </xsd:element>

 <!-- Response Message Type -->
 <xsd:element name="${t}Response">
 <xsd:complexType>
 <xsd:sequence>
 <xsd:element name="result" type="xsd:string"/>
 <xsd:element name="status" type="xsd:string"/>
 </xsd:sequence>
 </xsd:complexType>
 </xsd:element>

 <!-- Fault Message Type -->
 <xsd:element name="${t}Fault">
 <xsd:complexType>
 <xsd:sequence>
 <xsd:element name="faultCode" type="xsd:string"/>
 <xsd:element name="faultString" type="xsd:string"/>
 </xsd:sequence>
 </xsd:complexType>
 </xsd:element>`,s.forEach(c=>{(c.isComplexType||c.children&&c.children.length>0)&&(n+=`

 ${ws(c)}`)}),n+=`
 </xsd:schema>
 </types>

 <!-- Messages Section: Define input and output messages -->
 <message name="${t}RequestMessage">
 <part name="parameters" element="tns:${t}Request"/>
 </message>

 <message name="${t}ResponseMessage">
 <part name="parameters" element="tns:${t}Response"/>
 </message>

 <message name="${t}FaultMessage">
 <part name="fault" element="tns:${t}Fault"/>
 </message>

 <!-- Port Type/Interface: Group related operations -->
 <portType name="${a}PortType">
 <operation name="${t}">
 <documentation>Process data operation</documentation>
 <input message="tns:${t}RequestMessage"/>
 <output message="tns:${t}ResponseMessage"/>
 <fault name="${t}Fault" message="tns:${t}FaultMessage"/>
 </operation>
 </portType>

 <!-- Binding: Describe concrete protocol and data format (SOAP) -->
 <binding name="${a}SOAPBinding" type="tns:${a}PortType">
 <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
 <operation name="${t}">
 <soap:operation soapAction="http://example.com/service/${t}"/>
 <input>
 <soap:body use="literal"/>
 </input>
 <output>
 <soap:body use="literal"/>
 </output>
 <fault name="${t}Fault">
 <soap:fault name="${t}Fault" use="literal"/>
 </fault>
 </operation>
 </binding>

 <!-- Service: Network address (endpoint) - to be added by Java application -->
 <!--
 <service name="${a}">
 <port name="${a}SOAPPort" binding="tns:${a}SOAPBinding">
 <soap:address location="[ENDPOINT_URL_TO_BE_SET_BY_JAVA_APP]"/>
 </port>
 </service>
 -->

</definitions>`,n},Ts=(s,a)=>{if(s.length===0)return"";switch(a){case"json":return bs(s);case"xml":case"xsd":return Os(s);case"wsdl":return Ds(s);default:return JSON.stringify(s,null,2)}},$s=({fields:s,schemaType:a})=>s.length===0?null:e.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[e.jsxs(y,{className:"text-sm font-semibold mb-2 block",children:["; Live ",a.toUpperCase()," Preview:"]}),e.jsx("pre",{className:"text-xs bg-background p-3 rounded border overflow-auto max-h-64",children:Ts(s,a)})]}),Fs=({customFields:s,setCustomFields:a,selectedStructureType:t,setSelectedStructureType:n,onResetAllFields:c})=>{const[u,l]=p.useState(""),{toast:r}=V(),{addCustomField:m,updateFieldAtPath:i,removeFieldAtPath:d,addChildAtPath:o}=Cs(s,a),h=()=>{c(),r({title:"All Fields Cleared",description:"All form fields have been reset"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"customStructureType",children:"Structure Type"}),e.jsxs(W,{value:u,onValueChange:l,children:[e.jsx(q,{children:e.jsx(I,{placeholder:"Select structure type to build"})}),e.jsxs(U,{children:[e.jsx(T,{value:"json",children:"JSON Schema"}),e.jsx(T,{value:"xsd",children:"XSD Schema"}),e.jsx(T,{value:"xml",children:"XML Schema"}),e.jsx(T,{value:"wsdl",children:"WSDL Schema"})]})]})]}),u?s.length===0?e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx(Ce,{className:"h-12 w-12 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Build ",u.toUpperCase()," Structure"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Add fields to create your ",u.toUpperCase()," data structure"]}),e.jsxs(O,{onClick:()=>m(),className:"w-full max-w-xs bg-gradient-primary hover:opacity-90",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Field"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(y,{children:["Structure Definition (",u.toUpperCase(),")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{onClick:()=>m(),size:"sm",variant:"outline",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Field"]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:h,className:"text-destructive hover:text-destructive",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Clear All"]})]})]}),s.map((v,j)=>e.jsx($e,{field:v,index:j,onUpdate:i,onRemove:d,onAddChild:o,depth:0,path:[j]},j)),e.jsx($s,{fields:s,schemaType:u})]}):e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx(Ce,{className:"h-12 w-12 mx-auto text-muted-foreground opacity-50"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Custom Structure Builder"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select a structure type above to start building your custom data structure"})]})]})]})},Ls=({customFields:s,setCustomFields:a,jsonInput:t,setJsonInput:n,xsdInput:c,setXsdInput:u,edmxInput:l,setEdmxInput:r,wsdlInput:m,setWsdlInput:i,selectedStructureType:d,setSelectedStructureType:o,namespaceConfig:h,setNamespaceConfig:v,onSave:j,onWsdlAnalyzed:b,onResetAllFields:f,onFileUploaded:S})=>{const w=Oe(),D=()=>{w("/data-structures")};return e.jsxs(Z,{className:"animate-scale-in",style:{animationDelay:"0.1s"},children:[e.jsxs(ae,{children:[e.jsx(re,{children:"Define Structure"}),e.jsx(ue,{children:"Choose your preferred method to define the data structure"})]}),e.jsxs(ne,{children:[e.jsxs(ts,{value:d,className:"w-full",onValueChange:L=>o(L),children:[e.jsxs(as,{className:"grid w-full grid-cols-5",children:[e.jsx(K,{value:"json",children:"JSON Schema"}),e.jsx(K,{value:"xsd",children:"XSD/XML"}),e.jsx(K,{value:"wsdl",children:"WSDL"}),e.jsx(K,{value:"edmx",children:"EDMX"}),e.jsx(K,{value:"custom",children:"Custom Builder"})]}),e.jsx(Q,{value:"json",children:e.jsx(ps,{jsonInput:t,setJsonInput:n,onResetAllFields:f,onFileUploaded:S})}),e.jsx(Q,{value:"xsd",children:e.jsx(hs,{xsdInput:c,setXsdInput:u,namespaceConfig:h,setNamespaceConfig:v,onResetAllFields:f,onFileUploaded:S})}),e.jsx(Q,{value:"wsdl",children:e.jsx(js,{wsdlInput:m,setWsdlInput:i,namespaceConfig:h,setNamespaceConfig:v,onWsdlAnalyzed:b,onResetAllFields:f,onFileUploaded:S})}),e.jsx(Q,{value:"edmx",children:e.jsx(gs,{edmxInput:l,setEdmxInput:r,namespaceConfig:h,setNamespaceConfig:v,onResetAllFields:f,onFileUploaded:S})}),e.jsx(Q,{value:"custom",children:e.jsx(Fs,{customFields:s,setCustomFields:a,selectedStructureType:d,setSelectedStructureType:o,onResetAllFields:f})})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t flex gap-4",children:[e.jsxs(O,{onClick:D,variant:"outline",className:"flex-1",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs(O,{onClick:j,className:"flex-1 bg-gradient-primary hover:opacity-90",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Data Structure"]})]})]})]})},Fe=(s,a=0)=>s?e.jsx("div",{className:`ml-${a*4} space-y-1`,children:typeof s=="object"&&!Array.isArray(s)?Object.entries(s).map(([t,n])=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-primary",children:t}),e.jsx("span",{className:"text-muted-foreground",children:": "}),typeof n=="string"?e.jsx(je,{variant:"outline",className:"text-xs",children:n}):e.jsx("div",{className:"mt-1",children:Fe(n,a+1)})]},t)):e.jsx(je,{variant:"outline",className:"text-xs",children:String(s)})}):null,As=({selectedStructure:s})=>e.jsxs(Z,{className:"animate-scale-in",style:{animationDelay:"0.3s"},children:[e.jsx(ae,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Structure Preview"]})}),e.jsx(ne,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),s.namespace&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Namespace:"})," ",s.namespace.uri,s.namespace.prefix&&e.jsxs("span",{className:"ml-2",children:["(",s.namespace.prefix,")"]})]})]}),e.jsx(Ke,{}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg",children:[e.jsx(y,{className:"text-xs font-medium",children:"Structure Definition"}),e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto",children:Fe(s.structure)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(O,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})]}),tt=()=>{const{id:s}=Re(),a=Oe(),t=ke(),{saveStructure:n,updateStructure:c,loading:u}=qe();G.info(z.SYSTEM,"CreateDataStructure component rendering, loading",{data:u});const{toast:l}=V(),[r,m]=p.useState(!1),[i,d]=p.useState(null),[o,h]=p.useState("source"),[v,j]=p.useState(""),[b,f]=p.useState(""),[S,w]=p.useState(null),[D,L]=p.useState([]),[P,R]=p.useState(""),[E,F]=p.useState(""),[X,J]=p.useState(""),[k,M]=p.useState(""),[$,B]=p.useState("json"),[x,_]=p.useState({uri:"",prefix:"",targetNamespace:"",schemaLocation:""});p.useEffect(()=>{(async()=>{if(s)try{G.info(z.SYSTEM,"[CreateDataStructure] Loading structure for edit",{data:s});const g=await os.getStructure(s);if(g.success&&g.data){const C=g.data;m(!0),d(C.id),j(C.name||""),f(C.description||""),h(C.usage||"source"),B(C.type||"json"),C.type==="json"?R(JSON.stringify(C.structure,null,2)):C.type==="wsdl"?C.originalContent&&C.originalFormat==="xml"?M(C.originalContent):M(JSON.stringify(C.structure,null,2)):C.type==="xsd"?C.originalContent&&C.originalFormat==="xml"?F(C.originalContent):F(JSON.stringify(C.structure,null,2)):C.type,C.namespace&&_(C.namespace),C.businessComponent&&w({id:C.businessComponent.id,name:C.businessComponent.name,description:C.businessComponent.description||""})}}catch(g){G.error(z.ERROR,"Error loading structure",{error:g}),l({title:"Error",description:"Failed to load data structure",variant:"destructive"}),a("/data-structures")}else if(t.state?.structure&&t.state?.isEdit){const g=t.state.structure;G.info(z.SYSTEM,"[CreateDataStructure] Loading structure from navigation state",{data:g}),m(!0),d(g.id),j(g.name||""),f(g.description||""),h(g.usage||"source"),B(g.type||"json"),g.type==="json"?R(JSON.stringify(g.structure,null,2)):g.type==="wsdl"?M(JSON.stringify(g.structure,null,2)):g.type==="xsd"&&F(JSON.stringify(g.structure,null,2)),g.namespace&&_(g.namespace),g.businessComponent&&w({id:g.businessComponent.id,name:g.businessComponent.name,description:g.businessComponent.description||""})}})()},[s,t.state,a,l]);const pe=p.useMemo(()=>{if(!v)return null;let N={};if($==="json"&&P)N=Ie(P);else if($==="wsdl"&&k){const g=Ue(k);N=g?.structure||g}else $==="xsd"&&E?N={message:"XSD parsing not fully implemented yet"}:$==="edmx"&&X?N={message:"EDMX parsing not fully implemented yet"}:$==="custom"&&D.length>0&&(N=Xe(D));return!N||Object.keys(N).length===0?null:{id:"preview",name:v,type:$,description:b,structure:N,createdAt:new Date().toISOString().split("T")[0],usage:o,namespace:($==="xsd"||$==="wsdl"||$==="edmx")&&x.uri?x:void 0}},[v,b,$,P,E,X,k,D,x,o]),le=N=>{if(!N)return N;let g=N;return(g.endsWith("_Out")||g.endsWith("_In"))&&(g=g.substring(0,g.length-4)),g+(o==="source"?"_Out":"_In")},Le=(N,g)=>{N&&!v&&j(le(N)),g&&_(g)},Ae=async()=>{if(!S){l({title:"Validation Error",description:"Please select a business component",variant:"destructive"});return}let N=!1;r&&i?N=await c(i,v,b,o,P,E,X,k,D,$,x,S?.id):N=await n(v,b,o,P,E,X,k,D,$,x,S?.id),N&&(r?a("/data-structures"):(j(""),f(""),w(null),R(""),F(""),J(""),M(""),L([]),_({uri:"",prefix:"",targetNamespace:"",schemaLocation:""})))},Ee=()=>{j(""),f(""),w(null),R(""),F(""),J(""),M(""),L([]),_({uri:"",prefix:"",targetNamespace:"",schemaLocation:""}),B("json")};return u?e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"animate-slide-up",children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center gap-3",children:[e.jsx(be,{className:"h-8 w-8"}),"Data Structures"]}),e.jsx("p",{className:"text-muted-foreground",children:"Loading data structures..."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-32 bg-muted rounded-lg"})})})})]}):e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"animate-slide-up",children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center gap-3",children:[e.jsx(be,{className:"h-8 w-8"}),"Data Structures"]}),e.jsx("p",{className:"text-muted-foreground",children:"Define and manage data structures for source and target messages"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(xs,{selectedBusinessComponent:S,setSelectedBusinessComponent:w}),e.jsx(ms,{structureName:v,setStructureName:j,structureDescription:b,setStructureDescription:f,structureUsage:o,setStructureUsage:N=>{h(N),v&&j(le(v))},isEditMode:r}),e.jsx(Ls,{customFields:D,setCustomFields:L,jsonInput:P,setJsonInput:R,xsdInput:E,setXsdInput:F,edmxInput:X,setEdmxInput:J,wsdlInput:k,setWsdlInput:M,selectedStructureType:$,setSelectedStructureType:B,namespaceConfig:x,setNamespaceConfig:_,onSave:Ae,onWsdlAnalyzed:Le,onResetAllFields:Ee,onFileUploaded:N=>{if(!v&&N){const g=N.replace(/\.[^/.]+$/,"");j(le(g))}}}),pe&&e.jsx("div",{className:"animate-fade-in",children:e.jsx(As,{selectedStructure:pe})})]})]})};export{tt as CreateDataStructure};

import{j as e}from"./ui-vendor-B4gDKxp2.js";import{r as o}from"./react-vendor-pDgKdaAw.js";import{a as f,l as i,L as l,A as H,c as V,b as W,d as J,C as E,e as z,f as G,g as K,S as Q,h as _,i as ee,j as se,k as I,m as N,n as B,o as R,p as C,q as A,r as M,s as L,B as j,t as P,u as $,M as te,U as ae}from"./index-DseL_RUD.js";import{P as re}from"./progress-GuhXPMA5.js";import{u as ne,a as ce,P as oe}from"./useMetaDescription-DR4f5rZc.js";import{P as ie}from"./PageHeader-dkFzfZC5.js";import{b as le}from"./businessComponentService-p4rxceWm.js";import{S as k}from"./server-ztuRofsu.js";import{T as de}from"./trending-up-eJ29irQ-.js";import{Z as ue}from"./zap-DO1pOz0O.js";import"./chart-vendor-A7Ge_5Hb.js";class me{async getDashboardStats(a){try{const t=a?`/dashboard/stats?businessComponentId=${a}`:"/dashboard/stats";return await f.get(t)}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to fetch dashboard stats"}}}async getDashboardMetrics(a){try{const t=a?`/dashboard/metrics?businessComponentId=${a}`:"/dashboard/metrics",r=await f.get(t);if(r.success&&r.data){const n=r.data;return{success:!0,data:[{title:"Active Integrations",value:n.activeIntegrations?.toString()||"0",change:"+0%",icon:"Activity",color:"text-success"},{title:"Integration Flows Today",value:n.integrationFlowsToday?.toLocaleString()||"0",change:"+0%",icon:"MessageSquare",color:"text-info"},{title:"Success Rate",value:n.successRate?`${n.successRate.toFixed(1)}%`:"0.0%",change:"+0%",icon:"CheckCircle",color:"text-success"},{title:"Avg Response Time",value:n.avgResponseTime?`${n.avgResponseTime}ms`:"0ms",change:"0ms",icon:"Zap",color:"text-warning"}]}}return{success:!1,data:[],error:"Invalid response format"}}catch(t){return i.error(l.API,"Dashboard metrics error",{error:t}),{success:!1,data:[],error:t instanceof Error?t.message:"Failed to fetch dashboard metrics"}}}async getRecentIntegrationFlows(a,t=10){try{const r=a?`/flow-executions/recent?businessComponentId=${a}&limit=${t}`:`/flow-executions/recent?limit=${t}`;return await f.get(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to fetch recent integration flows"}}}async getAdapterStatuses(a){try{const t=a?`/adapter-monitoring/status?businessComponentId=${a}`:"/adapter-monitoring/status";return await f.get(t)}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to fetch adapter statuses"}}}async getDashboardData(a){try{const[t,r,n]=await Promise.all([this.getDashboardStats(a),this.getRecentIntegrationFlows(a),this.getAdapterStatuses(a)]);if(!t.success||!r.success||!n.success)return{success:!1,error:"Failed to fetch some dashboard data"};const u=await this.getDashboardMetrics(a);return{success:!0,data:{stats:t.data,metrics:u.data||[],recentIntegrationFlows:r.data||[],adapterStatuses:n.data||[]}}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to fetch dashboard data"}}}}const D=new me;function he({title:h="Error",error:a,className:t,variant:r="destructive"}){const n=a instanceof Error?a.message:typeof a=="string"?a:"An unexpected error occurred",u=r==="destructive"?E:z;return e.jsxs(H,{variant:r,className:V("mb-4",t),children:[e.jsx(u,{className:"h-4 w-4"}),e.jsx(W,{children:h}),e.jsx(J,{children:n})]})}const xe={Activity:B,MessageSquare:te,CheckCircle:P,XCircle:E,Clock:$,TrendingUp:de,Server:k,Zap:ue,Users:ae},Ce=()=>{ne("Dashboard"),ce("Monitor your integration flows, adapter status, and system performance in real-time with the Integrix Flow Bridge dashboard."),i.info(l.SYSTEM,"Dashboard component loading...");const[h,a]=o.useState(null),[t,r]=o.useState([]),[n,u]=o.useState([]),[x,v]=o.useState([]),[O,y]=o.useState(!0),[Y,S]=o.useState(!0),[q,b]=o.useState(!0),[F,T]=o.useState(null),[w,U]=o.useState([]),[X,Z]=o.useState(!0);return o.useEffect(()=>{(async()=>{try{i.info(l.SYSTEM,"Dashboard - loading business components...");const c=await le.getAllBusinessComponents();c.success&&c.data&&U(c.data)}catch(c){i.error(l.ERROR,"Error loading business components",{error:c})}finally{Z(!1)}})()},[]),i.info(l.SYSTEM,"Dashboard - business components",{data:w,loading:X}),o.useEffect(()=>{const s=async()=>{try{T(null);const d=h?.id;y(!0);const m=await D.getDashboardMetrics(d);i.info(l.SYSTEM,"Metrics response",{data:m}),m.success&&m.data&&Array.isArray(m.data)?r(m.data):(i.error(l.ERROR,"Failed to fetch metrics",{error:m.error}),r([])),y(!1),S(!0);const g=await D.getRecentMessages(d);g.success&&g.data?u(g.data):(i.error(l.ERROR,"Failed to fetch messages",{error:g.error}),u([])),S(!1),b(!0);const p=await D.getAdapterStatuses(d);p.success&&p.data?v(p.data):(i.error(l.ERROR,"Failed to fetch adapters",{error:p.error}),v([])),b(!1)}catch(d){i.error(l.ERROR,"Dashboard data fetch error",{error:d}),T("Failed to load dashboard data"),r([]),u([]),v([]),y(!1),S(!1),b(!1)}};s();const c=setInterval(s,3e4);return()=>clearInterval(c)},[h]),i.info(l.SYSTEM,"Dashboard render - about to return JSX"),e.jsxs(oe,{className:"max-w-none px-0 md:px-0",children:[e.jsx(ie,{title:"Integration Dashboard",description:"Monitor your integration flows and system health",icon:e.jsx(G,{})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(K,{htmlFor:"business-component",children:"Business Component:"}),e.jsxs(Q,{value:h?.id||"all",onValueChange:s=>{if(s==="all")a(null);else{const c=w.find(d=>d.id===s);a(c||null)}},children:[e.jsx(_,{id:"business-component",className:"w-[280px]",children:e.jsx(ee,{placeholder:"Select a business component"})}),e.jsxs(se,{children:[e.jsx(I,{value:"all",children:"All Components"}),w.map(s=>e.jsx(I,{value:s.id,children:s.name},s.id))]})]})]}),F&&e.jsx(he,{error:F}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:O?e.jsx("div",{className:"col-span-full flex justify-center p-8",children:e.jsx(N,{className:"h-8 w-8 animate-spin"})}):t&&Array.isArray(t)?t.map((s,c)=>{const d=xe[s.icon]||B,m=s.change.startsWith("+")||s.change.startsWith("-")&&s.change.includes("ms");return e.jsxs(R,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium",children:s.title}),e.jsx(d,{className:`h-4 w-4 ${s.color}`})]}),e.jsxs(M,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.value}),"`",e.jsxs("p",{className:`text-xs ${m?"text-success":"text-destructive"}`,children:[s.change," from last period"]})]})]},c)}):e.jsx("div",{className:"col-span-full",children:e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No metrics available"})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{children:[e.jsxs(C,{children:[e.jsx(A,{children:"Recent Integration Flows"}),e.jsx(L,{children:"Latest integration flow executions"})]}),e.jsx(M,{children:Y?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(N,{className:"h-6 w-6 animate-spin"})}):!n||!Array.isArray(n)||n.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No recent integration flows"}):e.jsx("div",{className:"space-y-4",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{variant:s.status==="success"?"success":s.status==="failed"?"destructive":"secondary",children:s.status}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.source," â†’ ",s.target]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.time})]})]}),s.status==="success"&&e.jsx(P,{className:"h-4 w-4 text-success"}),s.status==="failed"&&e.jsx(E,{className:"h-4 w-4 text-destructive"}),s.status==="processing"&&e.jsx($,{className:"h-4 w-4 text-warning animate-pulse"})]},s.id))})})]}),e.jsxs(R,{children:[e.jsxs(C,{children:[e.jsx(A,{children:"Adapter Monitoring"}),e.jsx(L,{children:"Active communication adapters"})]}),e.jsx(M,{children:q?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(N,{className:"h-6 w-6 animate-spin"})}):!x||!Array.isArray(x)||x.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No active adapters"}):e.jsx("div",{className:"space-y-4",children:x.map((s,c)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"outline",children:s.type}),e.jsx(j,{variant:"secondary",children:s.mode}),e.jsx(j,{variant:s.status==="running"?"success":s.status==="stopped"?"secondary":"destructive",children:s.status})]})]}),e.jsx(re,{value:s.load,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Load: ",s.load,"%"]}),s.messagesProcessed!==void 0&&e.jsxs("span",{children:["Messages: ",s.messagesProcessed.toLocaleString()]})]})]},c))})})]})]})]})};export{Ce as Dashboard};

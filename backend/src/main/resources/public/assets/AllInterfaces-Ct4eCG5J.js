import{j as e}from"./ui-vendor-B4gDKxp2.js";import{r as i,u as re}from"./react-vendor-pDgKdaAw.js";import{w as ie,a as I,F as B,m as w,v as c,B as y,an as de,o as R,p as M,q as V,r as O,I as ce,ah as oe,R as me,e as pe,Q as he,V as xe,W as ue,X as je,Y as C,Z as h,a7 as fe,y as ye}from"./index-j6L12q1O.js";import{T as ge,a as Ne,b as S,c as De}from"./tabs-qFpnyz_L.js";import{T as ve,a as we,b as $,c as j,d as Te,e as f}from"./table-DMqy019X.js";import{D as W,b as q,c as G,d as Y,e as Q,f as be}from"./dialog-DOGyEP5f.js";import{f as H}from"./flowService-CZ5RTZgT.js";import{S as Ce}from"./server-DQvOWjc-.js";import{G as Ae}from"./globe-ZaJJzieo.js";import{C as A}from"./copy-CAy57Gib.js";import{E as z}from"./external-link-klZSHAFT.js";import{F as Ee}from"./file-code-CUhIFQDB.js";import{F as Fe}from"./filter-B75PkAYV.js";import{S as Ie}from"./search-EIqf-oQo.js";import{E as Se,P as ke}from"./power-oosQWIg6.js";import{S as Pe}from"./square-pen-OlAUrgxR.js";import{T as Ue}from"./trash-2-UTmHvEBV.js";import"./chart-vendor-A7Ge_5Hb.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=ie("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);class Le{async deployFlow(r){try{return await I.post(`/flows/${r}/deployment/deploy`)}catch(n){let m="Failed to deploy flow";return n.message?m=n.message:n.response?.data?.message?m=n.response.data.message:n.response?.data?.error?m=n.response.data.error:typeof n=="string"&&(m=n),{success:!1,error:m}}}async undeployFlow(r){try{return{success:(await I.post(`/flows/${r}/deployment/undeploy`)).success}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Failed to undeploy flow"}}}async getDeploymentInfo(r){try{return await I.get(`/flows/${r}/deployment`)}catch(n){return{success:!1,error:n instanceof Error?n.message:"Failed to fetch deployment info"}}}}const k=new Le;function Re({flowId:o,flowName:r,open:n,onOpenChange:m}){const[T,g]=i.useState(!1),[a,E]=i.useState(null),{toast:N}=B();i.useEffect(()=>{n&&o&&x()},[n,o]);const x=async()=>{if(o){g(!0);try{const l=await k.getDeploymentInfo(o);l.success&&l.data?E(l.data):N({variant:"destructive",title:"Error",description:l.error||"Failed to fetch deployment information"})}catch{N({variant:"destructive",title:"Error",description:"Failed to fetch deployment information"})}finally{g(!1)}}},p=(l,F)=>{navigator.clipboard.writeText(l),N({title:"Copied!",description:`${F} copied to clipboard`})},D=l=>new Date(l).toLocaleString();return n?e.jsx(W,{open:n,onOpenChange:m,children:e.jsxs(q,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"Deployment Details"]}),e.jsx(Q,{children:r?`Deployment information for ${r}`:"Flow deployment information"})]}),T?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-8 w-8 animate-spin"})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Primary Endpoint"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 p-2 bg-muted rounded text-sm",children:a.endpoint}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>p(a.endpoint,"Endpoint"),children:e.jsx(A,{className:"h-4 w-4"})}),a.endpoint.startsWith("http")&&e.jsx(c,{size:"sm",variant:"outline",onClick:()=>window.open(a.endpoint,"_blank"),children:e.jsx(z,{className:"h-4 w-4"})})]})]}),a.metadata?.wsdlUrl&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"WSDL URL (Planned)"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 p-2 bg-muted rounded text-sm",children:a.metadata?.wsdlUrl||"N/A"}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>p(a.metadata?.wsdlUrl||"","WSDL URL"),disabled:!a.metadata?.wsdlUrl,children:e.jsx(A,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Note: The actual SOAP endpoint implementation is pending. This URL shows where the WSDL will be available once the endpoint is fully deployed."})]})]}),a.metadata?.apiDocsUrl&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"API Documentation"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 p-2 bg-muted rounded text-sm",children:a.metadata?.apiDocsUrl||"N/A"}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>p(a.metadata?.apiDocsUrl||"","API Docs URL"),disabled:!a.metadata?.apiDocsUrl,children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>window.open(a.metadata?.apiDocsUrl||"","_blank"),disabled:!a.metadata?.apiDocsUrl,children:e.jsx(z,{className:"h-4 w-4"})})]})]}),a.metadata?.openApiUrl&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"OpenAPI Specification"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 p-2 bg-muted rounded text-sm",children:a.metadata?.openApiUrl||"N/A"}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>p(a.metadata?.openApiUrl||"","OpenAPI URL"),disabled:!a.metadata?.openApiUrl,children:e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Deployment Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Adapter Type:"}),e.jsx(y,{variant:"outline",className:"ml-2",children:a.metadata?.adapterType||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Adapter Mode:"}),e.jsx(y,{variant:"outline",className:"ml-2",children:a.metadata?.adapterMode||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Deployed At:"}),e.jsx("span",{className:"ml-2",children:D(a.deployedAt)})]}),a.deployedBy&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Deployed By:"}),e.jsx("span",{className:"ml-2",children:a.deployedBy})]})]})]}),a.metadata&&Object.keys(a.metadata).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Additional Information"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[a.metadata.httpMethods&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"HTTP Methods:"}),e.jsx("span",{className:"ml-2",children:a.metadata.httpMethods})]}),a.metadata.contentType&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Content Type:"}),e.jsx("span",{className:"ml-2",children:a.metadata.contentType})]}),a.metadata.soapVersion&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"SOAP Version:"}),e.jsx("span",{className:"ml-2",children:a.metadata.soapVersion})]}),a.metadata.pollingEnabled!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Polling:"}),e.jsx("span",{className:"ml-2",children:a.metadata.pollingEnabled?"Enabled":"Disabled"})]}),a.metadata.filePattern&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"File Pattern:"}),e.jsx("span",{className:"ml-2",children:a.metadata.filePattern})]})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No deployment information available"})]})}):null}function as(){const o=re(),{toast:r}=B(),[n,m]=i.useState([]),[T,g]=i.useState(!0),[a,E]=i.useState(""),[N,x]=i.useState(!1),[p,D]=i.useState(null),[l,F]=i.useState("all"),[X,b]=i.useState(null),[P,Z]=i.useState(null),[J,U]=i.useState(!1);i.useEffect(()=>{u()},[u]);const u=i.useCallback(async()=>{try{g(!0);const s=await H.getFlows();if(s.success&&s.data){const t=Array.isArray(s.data)?s.data:s.data.flows||[];m(t)}}catch{r({variant:"destructive",title:"Error",description:"Failed to fetch interfaces"})}finally{g(!1)}},[r]),K=()=>{u(),r({title:"Success",description:"Interfaces refreshed"})},ee=s=>{D(s),x(!0)},se=async()=>{if(p)try{const s=await H.deleteFlow(p.id);if(s.success)r({title:"Success",description:"Interface deleted successfully"}),u();else throw new Error(s.error||"Failed to delete interface")}catch(s){r({variant:"destructive",title:"Error",description:s instanceof Error?s.message:"Failed to delete interface"})}finally{x(!1),D(null)}},L=async s=>{try{b(s.id);const t=await k.deployFlow(s.id);if(t.success)r({title:"Success",description:`Interface "${s.name}" has been deployed successfully`}),u();else{let d=t.error||"Failed to deploy interface";d.includes("Bad Request")||d.includes("HTTP 400")?d="Deployment failed. Please ensure all required components (adapters, data structures) are properly configured.":d.includes("not found")||d.includes("HTTP 404")?d="Deployment failed. Some required components could not be found.":d.includes("already deployed")||d.includes("HTTP 409")?d="This interface is already deployed. Please undeploy it first before redeploying.":(d.includes("validation failed")||d.includes("already exists"))&&(d="Deployment failed due to validation error. Please check flow configuration and try again."),r({variant:"destructive",title:"Deployment Failed",description:d})}}catch{r({variant:"destructive",title:"Error",description:"An error occurred during deployment"})}finally{b(null)}},ae=s=>{Z(s),U(!0)},te=async s=>{try{b(s.id);const t=await k.undeployFlow(s.id);t.success?(r({title:"Success",description:`Interface "${s.name}" has been undeployed successfully`}),u()):r({variant:"destructive",title:"Undeploy Failed",description:t.error||"Failed to undeploy interface"})}catch{}finally{b(null)}},v=(()=>{const s=n.filter(t=>t.name.toLowerCase().includes(a.toLowerCase())||t.description?.toLowerCase().includes(a.toLowerCase()));switch(l){case"undeployed":return s.filter(t=>t.status==="DEVELOPED_INACTIVE"||t.status==="DRAFT"||t.status==="INACTIVE");case"deployed":return s.filter(t=>t.status==="DEPLOYED_ACTIVE"||t.status==="ACTIVE");default:return s}})(),ne=s=>{const t={DEPLOYED_ACTIVE:"bg-green-500",DRAFT:"bg-blue-500",INACTIVE:"bg-gray-500",ERROR:"bg-red-500",DEVELOPED_INACTIVE:"bg-yellow-500"};return e.jsx(y,{className:`${t[s]||"bg-gray-500"} text-white`,children:s.replace("_"," ")})},le=s=>e.jsx(y,{variant:"outline",children:s==="WITH_MAPPING"?"With Mapping":"Pass Through"});return T?e.jsx("div",{className:"w-full p-6",children:e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(w,{className:"h-8 w-8 animate-spin"})})}):e.jsxs("div",{className:"w-full max-w-none p-8 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Interface Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage all your integration flows in one place"}),e.jsx("div",{className:"flex gap-2 mt-4",children:e.jsxs(c,{onClick:()=>o("/packages"),variant:"default",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Create Package"]})})]}),e.jsxs(ge,{value:l,onValueChange:F,className:"space-y-4",children:[e.jsxs(Ne,{className:"grid w-full grid-cols-3",children:[e.jsx(S,{value:"all",children:"All Interfaces"}),e.jsx(S,{value:"undeployed",children:"Undeployed"}),e.jsx(S,{value:"deployed",children:"Deployed"})]}),e.jsxs(R,{children:[e.jsx(M,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Filters"]})}),e.jsx(O,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(ce,{placeholder:"Search by name...",value:a,onChange:s=>E(s.target.value),className:"pl-10"})]})})]}),e.jsx(De,{value:l,children:e.jsxs(R,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5"}),l==="all"&&`All Interfaces (${v.length})`,l==="undeployed"&&`Undeployed Interfaces (${v.length})`,l==="deployed"&&`Deployed Interfaces (${v.length})`]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:K,children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),e.jsx(O,{children:T?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading interfaces..."})}):v.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pe,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"No interfaces found matching your search.":l==="deployed"?"No deployed interfaces found.":l==="undeployed"?"No undeployed interfaces found.":"No interfaces created yet."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ve,{children:[e.jsx(we,{children:e.jsxs($,{children:[e.jsx(j,{children:"Name"}),e.jsx(j,{children:"Type"}),e.jsx(j,{children:"Source → Target"}),e.jsx(j,{children:"Status"}),e.jsx(j,{children:"Created"}),e.jsx(j,{children:"Actions"})]})}),e.jsx(Te,{children:v.map(s=>{const t=X===s.id;return e.jsxs($,{children:[e.jsx(f,{className:"font-medium",children:s.name}),e.jsx(f,{children:le(s.mappingMode||"PASS_THROUGH")}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(y,{variant:"outline",children:s.inboundAdapterType||"Unknown"}),e.jsx("span",{children:"→"}),e.jsx(y,{variant:"outline",children:s.outboundAdapterType||"Unknown"})]})}),e.jsx(f,{children:ne(s.status)}),e.jsx(f,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(f,{children:e.jsxs(he,{children:[e.jsx(xe,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"sm",children:e.jsx(Se,{className:"h-4 w-4"})})}),e.jsxs(ue,{align:"end",children:[e.jsx(je,{children:"Actions"}),e.jsx(C,{}),l==="undeployed"?e.jsxs(h,{onClick:()=>L(s),disabled:t||s.status==="DRAFT",children:[t?e.jsx(w,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(_,{className:"h-4 w-4 mr-2"}),"Deploy"]}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{onClick:()=>o(`/interfaces/${s.id}/details`),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(h,{onClick:()=>o(`/flows/${s.id}/edit`),children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Edit"]}),l==="all"&&(s.status==="DEVELOPED_INACTIVE"||s.status==="DRAFT"||s.status==="INACTIVE")&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs(h,{onClick:()=>L(s),disabled:t||s.status==="DRAFT",children:[t?e.jsx(w,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(_,{className:"h-4 w-4 mr-2"}),"Deploy"]})]}),(l==="deployed"||l==="all"&&s.status==="DEPLOYED_ACTIVE")&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs(h,{onClick:()=>ae(s),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"View Deployment Details"]}),e.jsxs(h,{onClick:()=>te(s),disabled:t,children:[t?e.jsx(w,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Undeploy"]})]}),e.jsx(C,{}),e.jsxs(h,{onClick:()=>ee(s),className:"text-red-600",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})})]},s.id)})})]})})})]})})]}),e.jsx(W,{open:N,onOpenChange:x,children:e.jsxs(q,{children:[e.jsxs(G,{children:[e.jsx(Y,{children:"Delete Interface"}),e.jsxs(Q,{children:['Are you sure you want to delete "',p?.name,'"? This action cannot be undone.']})]}),e.jsxs(be,{children:[e.jsx(c,{variant:"outline",onClick:()=>{x(!1),D(null)},children:"Cancel"}),e.jsx(c,{variant:"destructive",onClick:se,children:"Delete"})]})]})}),e.jsx(Re,{flowId:P?.id||null,flowName:P?.name,open:J,onOpenChange:U})]})}export{as as default};
